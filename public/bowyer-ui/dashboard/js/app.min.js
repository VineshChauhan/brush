var bowyerApp;!function(){"use strict";bowyerApp=angular.module("bowyer",["ngAnimate","ngCookies","ngTouch","ngSanitize","ui.router","ui.bootstrap","LocalStorageModule"])}(),function(){"use strict";function e(e,t,r){e.state("login",{url:"/login",templateUrl:"bowyer-ui/dashboard/partials/login/login.html",controller:"loginCtrl",controllerAs:"login"}).state("logout",{url:"/logout",controller:"logoutCtrl",controllerAs:"logout"}).state("forgotPassword",{url:"/forgotPassword",templateUrl:"bowyer-ui/dashboard/partials/forgotPassword/forgotPassword.html"}).state("register",{url:"/register",templateUrl:"bowyer-ui/dashboard/partials/register/register.html",controller:"registerCtrl",controllerAs:"register"}).state("dashboard",{url:"/",templateUrl:"bowyer-ui/dashboard/partials/dashboard/dashboard.html"}).state("dashboard.alerts",{url:"alerts",templateUrl:"bowyer-ui/dashboard/partials/dashboard/alerts/alerts.html"}).state("dashboard.users",{url:"users",controller:"usersCtrl",controllerAs:"users",templateUrl:"bowyer-ui/dashboard/partials/dashboard/users/users.html"}).state("dashboard.profile",{url:"profile",templateUrl:"bowyer-ui/dashboard/partials/dashboard/profile/profile.html",controller:"profileCtrl",controllerAs:"profile"}).state("dashboard.resetPassword",{url:"resetPassword",templateUrl:"bowyer-ui/dashboard/partials/dashboard/resetPassword/resetPassword.html",controller:"resetPasswordCtrl",controllerAs:"resetPassword"}).state("dashboard.api",{url:"api",templateUrl:"bowyer-ui/dashboard/partials/dashboard/api/api.html"}).state("dashboard.analytics",{url:"analytics",templateUrl:"bowyer-ui/dashboard/partials/dashboard/analytics/analytics.html"}).state("dashboard.config",{url:"config",templateUrl:"bowyer-ui/dashboard/partials/dashboard/config/config.html",controller:"configCtrl",controllerAs:"config"}).state("dashboard.config.roles",{url:"/roles",templateUrl:"bowyer-ui/dashboard/partials/dashboard/config/roles/roles.html",controller:"rolesCtrl",controllerAs:"roles"}).state("dashboard.config.navigation",{url:"/navigation",templateUrl:"bowyer-ui/dashboard/partials/dashboard/config/navigation/navigation.html"}).state("dashboard.healthcheck",{url:"healthcheck",templateUrl:"bowyer-ui/dashboard/partials/dashboard/healthcheck/healthcheck.html",controller:"healthCheckCtrl as vm"}),t.otherwise("/login"),r.setPrefix("bowyer")}bowyerApp.config(e)}(),function(){"use strict";function e(e,t){e.defaults.headers.common.apitoken=t.get("api_token")}bowyerApp.run(e)}(),function(){"use strict";angular.module("bowyer").controller("dashboardCtrl",["$scope",function(e){}])}(),function(){"use strict";bowyerApp.controller("loginCtrl",["api","$state","localStorageService","constants",function(e,t,r,o){var a=this;a.validateLogin=function(){a.loginError=!1;var s={url:"/api/login",data:{username:a.username,password:a.password},method:o.method.post};e.executeCall(s).then(function(o){o.data.api_token?(r.set("api_token",o.data.api_token),e.addTokenToCalls(),t.go("dashboard")):a.loginError=o.data.message},function(e){console.log(e)})}}])}(),function(){"use strict";bowyerApp.controller("logoutCtrl",["api","$state","localStorageService","constants",function(e,t,r,o){var a={url:"/api/logout"};e.executeCall(a).then(function(e){t.go("login")},e.logout(function(e){console.error(e)}))}])}(),function(){"use strict";bowyerApp.controller("registerCtrl",["api","$state","localStorageService","constants",function(e,t,r,o){var a=this;a.validateRegister=function(){if(a.registerError=!1,a.formData){var t={url:"/api/register",data:{username:a.formData.username,email:a.formData.email,password:a.formData.password},method:o.method.post};e.executeCall(t).then(function(e){e.data.user_id?(a.registerError={message:"User has been created.",type:"success"},a.formData={}):a.registerError=e.data},function(e){console.log(e)})}else a.registerError={message:"Username, email and password are mandatory.",type:"danger"}}}])}(),function(){"use strict";bowyerApp.factory("api",["$http","constants","$state","localStorageService",function(e,t,r,o){return{executeCall:function(r){return r.method===t.method.post?e.post(r.url,r.data):r.method===t.method["delete"]?e["delete"](r.url):e.get(r.url)},logout:function(e){return function(t){401===t.status?(o.clearAll(),r.go("login")):e&&e(t)}},addTokenToCalls:function(){e.defaults.headers.common.apitoken=o.get("api_token")}}}])}(),function(){"use strict";bowyerApp.factory("commonFactory",[function(){return{}}])}(),function(){"use strict";bowyerApp.factory("constants",[function(){return{method:{post:"POST","delete":"DELETE",get:"GET"}}}])}(),function(){"use strict";bowyerApp.controller("configCtrl",["$scope",function(e){}])}(),function(){"use strict";bowyerApp.controller("healthCheckCtrl",["api","localStorageService","healthCheckFactory",function(e,t,r){var o=this;o.api=r.initial,o.db=r.initial,o.ls=r.initial;var a={url:"/api/healthCheck/apiCheck"},s={url:"/api/healthCheck/dbCheck"};e.executeCall(a).then(function(e){o.api=r.success},e.logout(function(e){o.api=r.failed})),e.executeCall(s).then(function(e){o.db=r.success,e.data.api_token===t.get("api_token")?o.ls=r.success:o.ls=r.failed},e.logout(function(e){o.db=r.failed,o.ls=r.failed}))}])}(),function(){"use strict";bowyerApp.factory("healthCheckFactory",function(){return{initial:{checkValue:0,checkMessage:"checking ...",type:"warning"},success:{checkValue:100,checkMessage:"Healthy",checkPass:!0,type:"success"},failed:{checkValue:100,checkMessage:"Failed",type:"danger"}}})}(),function(){"use strict";bowyerApp.controller("profileCtrl",["api","constants",function(e,t){var r=this,o={url:"/api/user/profile"};r.roles=[{role_id:1,role_desc:"Admin"},{role_id:2,role_desc:"Regular User"}],e.executeCall(o).then(function(e){r.user=e.data},e.logout(function(e){console.log(e)})),r.validateAndSave=function(){o.method=t.method.post,o.data=r.user,e.executeCall(o).then(function(e){r.profileError=e.data},e.logout(function(e){console.log(e)}))}}])}(),function(){"use strict";bowyerApp.controller("resetPasswordCtrl",["api","constants",function(e,t){var r=this;r.validateAndSave=function(){if(r.error={},r.formData)if(r.formData.newPassword&&""!==r.formData.newPassword&&r.formData.newPassword===r.formData.confirmPassword){var o={url:"/api/user/resetPassword",method:t.method.post,data:r.formData};e.executeCall(o).then(function(e){r.resetPasswordError=e.data,"success"===r.resetPasswordError.type?r.formData={}:r.error.password=!0},e.logout(function(e){console.log(e)}))}else r.error={newPassword:!0,confirmPassword:!0};else r.error={password:!0,newPassword:!0,confirmPassword:!0}}}])}(),function(){"use strict";bowyerApp.controller("usersCtrl",["api","constants",function(e,t){var r=this,o={url:"/api/admin/users"};e.executeCall(o).then(function(e){r.users=e.data},e.logout(function(e){console.log(e)})),r.deleteUser=function(r){r.deleteInitiated=!0;var o={url:"/api/admin/user/"+r.user_id,method:t.method["delete"]};e.executeCall(o).then(function(e){"success"===e.data.type&&(r.deleted="Y")},e.logout(function(e){console.log(e)}))}}])}(),function(){"use strict";bowyerApp.directive("bowyerLogo",function(){return{restrict:"EA",template:'<span>bow</span><span style="color:#F39C12">yer</span>'}})}(),function(){"use strict";bowyerApp.controller("rolesCtrl",["api",function(e){var t=this,r={url:"/api/admin/roles"};e.executeCall(r).then(function(e){t.roles=e.data},e.logout(function(e){}))}])}();